<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Enterprise-grade distributed service mesh for MCP agents. Kubernetes-native platform with zero-boilerplate dependency injection."><meta name=author content="MCP Mesh Contributors"><link href=https://dhyansraj.github.io/mcp-mesh/06-helm-deployment/01-understanding-charts/ rel=canonical><link href=../ rel=prev><link href=../02-umbrella-chart/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>Understanding Charts - MCP Mesh</title><link rel=stylesheet href=../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../assets/stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Google Search Console Verification --><meta name=google-site-verification content=EtV7XZPdw0d9azFHor7Zq2BeuVZVnwSwD0zzGNMOUoM></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#understanding-mcp-mesh-helm-charts class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="MCP Mesh" class="md-header__button md-logo" aria-label="MCP Mesh" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MCP Mesh </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Understanding Charts </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/dhyansraj/mcp-mesh title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> dhyansraj/mcp-mesh </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../01-getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../03-docker-deployment/01-building-images/ class=md-tabs__link> Deployment </a> </li> <li class=md-tabs__item> <a href=../../07-observability/01-prometheus-integration/ class=md-tabs__link> Observability </a> </li> <li class=md-tabs__item> <a href=../../architecture-and-design/ class=md-tabs__link> Reference </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="MCP Mesh" class="md-nav__button md-logo" aria-label="MCP Mesh" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> MCP Mesh </label> <div class=md-nav__source> <a href=https://github.com/dhyansraj/mcp-mesh title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> dhyansraj/mcp-mesh </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../01-getting-started/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../02-local-development/ class=md-nav__link> <span class=md-ellipsis> Local Development </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex> <span class=md-ellipsis> Docker </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../03-docker-deployment/01-building-images/ class=md-nav__link> <span class=md-ellipsis> Building Images </span> </a> </li> <li class=md-nav__item> <a href=../../03-docker-deployment/02-running-locally.md class=md-nav__link> <span class=md-ellipsis> Running Locally </span> </a> </li> <li class=md-nav__item> <a href=../../03-docker-deployment/03-docker-compose.md class=md-nav__link> <span class=md-ellipsis> Docker Compose </span> </a> </li> <li class=md-nav__item> <a href=../../03-docker-deployment/04-networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class=md-nav__item> <a href=../../03-docker-deployment/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Kubernetes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../04-kubernetes-basics/ class=md-nav__link> <span class=md-ellipsis> Basics </span> </a> </li> <li class=md-nav__item> <a href=../../04-kubernetes-basics/03-kubectl-deployment/ class=md-nav__link> <span class=md-ellipsis> kubectl Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../04-kubernetes-basics/04-kustomize.md class=md-nav__link> <span class=md-ellipsis> Kustomize </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Helm </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Helm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Understanding Charts </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Understanding Charts </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#key-concepts class=md-nav__link> <span class=md-ellipsis> Key Concepts </span> </a> </li> <li class=md-nav__item> <a href=#step-by-step-guide class=md-nav__link> <span class=md-ellipsis> Step-by-Step Guide </span> </a> <nav class=md-nav aria-label="Step-by-Step Guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-explore-chart-structure class=md-nav__link> <span class=md-ellipsis> Step 1: Explore Chart Structure </span> </a> </li> <li class=md-nav__item> <a href=#step-2-registry-chart-deep-dive class=md-nav__link> <span class=md-ellipsis> Step 2: Registry Chart Deep Dive </span> </a> </li> <li class=md-nav__item> <a href=#step-3-agent-chart-deep-dive class=md-nav__link> <span class=md-ellipsis> Step 3: Agent Chart Deep Dive </span> </a> </li> <li class=md-nav__item> <a href=#step-4-understanding-template-helpers class=md-nav__link> <span class=md-ellipsis> Step 4: Understanding Template Helpers </span> </a> </li> <li class=md-nav__item> <a href=#step-5-values-file-structure class=md-nav__link> <span class=md-ellipsis> Step 5: Values File Structure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration-options class=md-nav__link> <span class=md-ellipsis> Configuration Options </span> </a> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-1-custom-agent-chart class=md-nav__link> <span class=md-ellipsis> Example 1: Custom Agent Chart </span> </a> </li> <li class=md-nav__item> <a href=#example-2-template-customization class=md-nav__link> <span class=md-ellipsis> Example 2: Template Customization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls class=md-nav__link> <span class=md-ellipsis> Common Pitfalls </span> </a> <nav class=md-nav aria-label="Common Pitfalls"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pitfall-1-incorrect-indentation class=md-nav__link> <span class=md-ellipsis> Pitfall 1: Incorrect Indentation </span> </a> </li> <li class=md-nav__item> <a href=#pitfall-2-missing-quotes class=md-nav__link> <span class=md-ellipsis> Pitfall 2: Missing Quotes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> <nav class=md-nav aria-label=Testing> <ul class=md-nav__list> <li class=md-nav__item> <a href=#template-testing class=md-nav__link> <span class=md-ellipsis> Template Testing </span> </a> </li> <li class=md-nav__item> <a href=#unit-testing-with-helm class=md-nav__link> <span class=md-ellipsis> Unit Testing with Helm </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#monitoring-and-debugging class=md-nav__link> <span class=md-ellipsis> Monitoring and Debugging </span> </a> <nav class=md-nav aria-label="Monitoring and Debugging"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#debug-helm-installations class=md-nav__link> <span class=md-ellipsis> Debug Helm Installations </span> </a> </li> <li class=md-nav__item> <a href=#monitor-chart-usage class=md-nav__link> <span class=md-ellipsis> Monitor Chart Usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> 🔧 Troubleshooting </span> </a> <nav class=md-nav aria-label="🔧 Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#issue-1-template-function-not-found class=md-nav__link> <span class=md-ellipsis> Issue 1: Template Function Not Found </span> </a> </li> <li class=md-nav__item> <a href=#issue-2-values-not-propagating class=md-nav__link> <span class=md-ellipsis> Issue 2: Values Not Propagating </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#known-limitations class=md-nav__link> <span class=md-ellipsis> ⚠️ Known Limitations </span> </a> </li> <li class=md-nav__item> <a href=#todo class=md-nav__link> <span class=md-ellipsis> 📝 TODO </span> </a> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../02-umbrella-chart/ class=md-nav__link> <span class=md-ellipsis> Multi-Agent Deployment </span> </a> </li> <li class=md-nav__item> <a href=../03-customizing-values/ class=md-nav__link> <span class=md-ellipsis> Customizing Values </span> </a> </li> <li class=md-nav__item> <a href=../04-multi-environment/ class=md-nav__link> <span class=md-ellipsis> Multi-Environment </span> </a> </li> <li class=md-nav__item> <a href=../05-best-practices/ class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Observability </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Observability </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../07-observability/01-prometheus-integration/ class=md-nav__link> <span class=md-ellipsis> Prometheus Integration </span> </a> </li> <li class=md-nav__item> <a href=../../07-observability/02-grafana-dashboards/ class=md-nav__link> <span class=md-ellipsis> Grafana Dashboards </span> </a> </li> <li class=md-nav__item> <a href=../../07-observability/03-distributed-tracing/ class=md-nav__link> <span class=md-ellipsis> Distributed Tracing </span> </a> </li> <li class=md-nav__item> <a href=../../07-observability/04-centralized-logging/ class=md-nav__link> <span class=md-ellipsis> Centralized Logging </span> </a> </li> <li class=md-nav__item> <a href=../../07-observability/05-alerting-slos/ class=md-nav__link> <span class=md-ellipsis> Alerting & SLOs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture-and-design/ class=md-nav__link> <span class=md-ellipsis> Architecture & Design </span> </a> </li> <li class=md-nav__item> <a href=../../mesh-decorators/ class=md-nav__link> <span class=md-ellipsis> Mesh Decorators </span> </a> </li> <li class=md-nav__item> <a href=../../environment-variables/ class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> <li class=md-nav__item> <a href=../../meshctl-cli/ class=md-nav__link> <span class=md-ellipsis> meshctl CLI </span> </a> </li> <li class=md-nav__item> <a href=../../enhanced-tag-matching-migration/ class=md-nav__link> <span class=md-ellipsis> Tag Matching Migration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=understanding-mcp-mesh-helm-charts>Understanding MCP Mesh Helm Charts<a class=headerlink href=#understanding-mcp-mesh-helm-charts title="Permanent link">&para;</a></h1> <blockquote> <p>Learn the structure and components of MCP Mesh Helm charts</p> </blockquote> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>MCP Mesh provides two primary Helm charts: <code>mcp-mesh-registry</code> for the central registry service and <code>mcp-mesh-agent</code> for deploying agents. This guide explains the chart structure, templates, values, and how to use them effectively. Understanding these charts is essential for customizing deployments and creating your own agent charts. We'll explore each component, explain the templating patterns used, and show how to extend the charts for your specific needs.</p> <h2 id=key-concepts>Key Concepts<a class=headerlink href=#key-concepts title="Permanent link">&para;</a></h2> <ul> <li><strong>Chart Structure</strong>: Standard Helm chart layout and files</li> <li><strong>Templates</strong>: Go templating for Kubernetes manifests</li> <li><strong>Values</strong>: Configuration options and defaults</li> <li><strong>Helpers</strong>: Reusable template functions</li> <li><strong>Dependencies</strong>: Chart relationships and requirements</li> </ul> <h2 id=step-by-step-guide>Step-by-Step Guide<a class=headerlink href=#step-by-step-guide title="Permanent link">&para;</a></h2> <h3 id=step-1-explore-chart-structure>Step 1: Explore Chart Structure<a class=headerlink href=#step-1-explore-chart-structure title="Permanent link">&para;</a></h3> <p>Both MCP Mesh charts follow standard Helm conventions:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>mcp-mesh-registry/
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>├── Chart.yaml              # Chart metadata
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>├── values.yaml             # Default configuration
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>├── templates/              # Kubernetes manifests
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>│   ├── _helpers.tpl        # Template helpers
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>│   ├── statefulset.yaml    # 🎯 StatefulSet (not Deployment)
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>│   ├── service.yaml        # Service definition
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>│   ├── service-headless.yaml  # 🎯 Headless service for StatefulSet
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>│   ├── configmap.yaml      # Configuration
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>│   ├── secret.yaml         # Sensitive data
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>│   ├── ingress.yaml        # Ingress rules
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>│   ├── hpa.yaml            # Autoscaling
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>│   └── NOTES.txt           # Post-install notes
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>└── README.md              # Chart documentation
</span></code></pre></div> <h3 id=step-2-registry-chart-deep-dive>Step 2: Registry Chart Deep Dive<a class=headerlink href=#step-2-registry-chart-deep-dive title="Permanent link">&para;</a></h3> <p>🎯 <strong>Updated</strong>: The registry chart now uses StatefulSet (matches working K8s examples) for data persistence and proper service discovery:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># mcp-mesh-registry/templates/statefulset.yaml</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">StatefulSet</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-registry.labels&quot; . | nindent 4</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">-headless</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.replicaCount</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-registry.selectorLabels&quot; . | nindent 6</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>  </span><span class=nt>template</span><span class=p>:</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>      </span><span class=nt>annotations</span><span class=p>:</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=w>        </span><span class=nt>checksum/config</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include (print $.Template.BasePath &quot;/configmap.yaml&quot;) . | sha256sum</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.podAnnotations</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=w>      </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-registry.selectorLabels&quot; . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=w>      </span><span class=nt>serviceAccountName</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.serviceAccountName&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=w>      </span><span class=nt>securityContext</span><span class=p>:</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.podSecurityContext | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Chart.Name</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=w>        </span><span class=nt>securityContext</span><span class=p>:</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.securityContext | nindent 12</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.repository</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}:{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.tag</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>default</span><span class=nv> </span><span class=s>.Chart.AppVersion</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}&quot;</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=w>        </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.image.pullPolicy</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;/app/bin/registry&quot;</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># 🎯 Matches working examples</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=w>        </span><span class=nt>ports</span><span class=p>:</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=w>          </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.registry.port</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class=w>  </span><span class=c1># 🎯 Default 8000</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=w>          </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=w>          </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=w>          </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=w>        </span><span class=c1># 🎯 Pod information for registry</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">POD_NAME</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metadata.name</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">POD_IP</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">status.podIP</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">POD_NAMESPACE</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metadata.namespace</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if ne .Values.registry.database.type &quot;sqlite&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_PASSWORD</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a><span class=w>            </span><span class=nt>secretKeyRef</span><span class=p>:</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a><span class=w>              </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">-secret</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a><span class=w>              </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">database-password</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a><span class=w>        </span><span class=nt>envFrom</span><span class=p>:</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>configMapRef</span><span class=p>:</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">-config</span><span class=w>  </span><span class=c1># 🎯 Updated naming</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a><span class=w>        </span><span class=nt>livenessProbe</span><span class=p>:</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/health</span><span class=w>  </span><span class=c1># 🎯 Consistent health endpoint</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a><span class=w>          </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a><span class=w>          </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a><span class=w>        </span><span class=nt>readinessProbe</span><span class=p>:</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/health</span><span class=w>  </span><span class=c1># 🎯 Updated to match working examples</span>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a><span class=w>          </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=w>          </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a><span class=w>        </span><span class=nt>startupProbe</span><span class=p>:</span>
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a><span class=w>          </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=w>          </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=w>        </span><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.resources | nindent 12</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
</span><span id=__span-1-93><a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a><span class=w>          </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/data</span>
</span><span id=__span-1-94><a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.extraVolumeMounts</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-95><a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.extraVolumeMounts | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-96><a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-97><a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.nodeSelector</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-98><a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a><span class=w>      </span><span class=nt>nodeSelector</span><span class=p>:</span>
</span><span id=__span-1-99><a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-100><a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-101><a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.affinity</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-102><a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a><span class=w>      </span><span class=nt>affinity</span><span class=p>:</span>
</span><span id=__span-1-103><a id=__codelineno-1-103 name=__codelineno-1-103 href=#__codelineno-1-103></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-104><a id=__codelineno-1-104 name=__codelineno-1-104 href=#__codelineno-1-104></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-105><a id=__codelineno-1-105 name=__codelineno-1-105 href=#__codelineno-1-105></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.tolerations</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-106><a id=__codelineno-1-106 name=__codelineno-1-106 href=#__codelineno-1-106></a><span class=w>      </span><span class=nt>tolerations</span><span class=p>:</span>
</span><span id=__span-1-107><a id=__codelineno-1-107 name=__codelineno-1-107 href=#__codelineno-1-107></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-108><a id=__codelineno-1-108 name=__codelineno-1-108 href=#__codelineno-1-108></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-109><a id=__codelineno-1-109 name=__codelineno-1-109 href=#__codelineno-1-109></a><span class=w>  </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.persistence.enabled</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-110><a id=__codelineno-1-110 name=__codelineno-1-110 href=#__codelineno-1-110></a><span class=w>  </span><span class=nt>volumeClaimTemplates</span><span class=p>:</span>
</span><span id=__span-1-111><a id=__codelineno-1-111 name=__codelineno-1-111 href=#__codelineno-1-111></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-1-112><a id=__codelineno-1-112 name=__codelineno-1-112 href=#__codelineno-1-112></a><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">data</span>
</span><span id=__span-1-113><a id=__codelineno-1-113 name=__codelineno-1-113 href=#__codelineno-1-113></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-1-114><a id=__codelineno-1-114 name=__codelineno-1-114 href=#__codelineno-1-114></a><span class=w>      </span><span class=nt>accessModes</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.persistence.accessModes</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-115><a id=__codelineno-1-115 name=__codelineno-1-115 href=#__codelineno-1-115></a><span class=w>      </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.persistence.storageClassName</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-116><a id=__codelineno-1-116 name=__codelineno-1-116 href=#__codelineno-1-116></a><span class=w>      </span><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-1-117><a id=__codelineno-1-117 name=__codelineno-1-117 href=#__codelineno-1-117></a><span class=w>        </span><span class=nt>requests</span><span class=p>:</span>
</span><span id=__span-1-118><a id=__codelineno-1-118 name=__codelineno-1-118 href=#__codelineno-1-118></a><span class=w>          </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.persistence.size</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-1-119><a id=__codelineno-1-119 name=__codelineno-1-119 href=#__codelineno-1-119></a><span class=w>  </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h3 id=step-3-agent-chart-deep-dive>Step 3: Agent Chart Deep Dive<a class=headerlink href=#step-3-agent-chart-deep-dive title="Permanent link">&para;</a></h3> <p>The agent chart is more flexible, supporting various agent configurations:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># mcp-mesh-agent/templates/deployment.yaml</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>  </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-agent.labels&quot; . | nindent 4</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.replicaCount</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-agent.selectorLabels&quot; . | nindent 6</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>  </span><span class=nt>template</span><span class=p>:</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>      </span><span class=nt>annotations</span><span class=p>:</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.configMap</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>        </span><span class=nt>checksum/config</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include (print $.Template.BasePath &quot;/configmap.yaml&quot;) . | sha256sum</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.podAnnotations</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=w>      </span><span class=nt>labels</span><span class=p>:</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- include &quot;mcp-mesh-agent.selectorLabels&quot; . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- with .Values.agent.labels</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml . | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=w>      </span><span class=nt>serviceAccountName</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.serviceAccountName&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=w>      </span><span class=nt>securityContext</span><span class=p>:</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.podSecurityContext | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.initContainers</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=w>      </span><span class=nt>initContainers</span><span class=p>:</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.agent.initContainers | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Chart.Name</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=w>        </span><span class=nt>securityContext</span><span class=p>:</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.securityContext | nindent 12</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.repository</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}:{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.tag</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>default</span><span class=nv> </span><span class=s>.Chart.AppVersion</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}&quot;</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=w>        </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.image.pullPolicy</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;python&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;/app/agent.py&quot;</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># 🎯 Matches working examples</span>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=w>        </span><span class=nt>ports</span><span class=p>:</span>
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=w>          </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.agent.http.port | default 8080</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class=w>  </span><span class=c1># 🎯 Standard port 8080</span>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a><span class=w>          </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.metrics.enabled</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
</span><span id=__span-2-48><a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a><span class=w>          </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id=__span-2-49><a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=w>          </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</span><span id=__span-2-50><a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-51><a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-2-52><a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">AGENT_NAME</span>
</span><span id=__span-2-53><a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.agent.name | quote</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-54><a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">POD_NAME</span>
</span><span id=__span-2-55><a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-2-56><a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span>
</span><span id=__span-2-57><a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metadata.name</span>
</span><span id=__span-2-58><a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">POD_IP</span>
</span><span id=__span-2-59><a id=__codelineno-2-59 name=__codelineno-2-59 href=#__codelineno-2-59></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-2-60><a id=__codelineno-2-60 name=__codelineno-2-60 href=#__codelineno-2-60></a><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span>
</span><span id=__span-2-61><a id=__codelineno-2-61 name=__codelineno-2-61 href=#__codelineno-2-61></a><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">status.podIP</span>
</span><span id=__span-2-62><a id=__codelineno-2-62 name=__codelineno-2-62 href=#__codelineno-2-62></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MCP_MESH_REGISTRY_URL</span>
</span><span id=__span-2-63><a id=__codelineno-2-63 name=__codelineno-2-63 href=#__codelineno-2-63></a><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.agent.registryUrl | quote</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-64><a id=__codelineno-2-64 name=__codelineno-2-64 href=#__codelineno-2-64></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.capabilities</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-65><a id=__codelineno-2-65 name=__codelineno-2-65 href=#__codelineno-2-65></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MCP_MESH_CAPABILITIES</span>
</span><span id=__span-2-66><a id=__codelineno-2-66 name=__codelineno-2-66 href=#__codelineno-2-66></a><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.agent.capabilities | join &quot;</span><span class="p p-Indicator">,</span><span class=s>&quot;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>quote</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-67><a id=__codelineno-2-67 name=__codelineno-2-67 href=#__codelineno-2-67></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>end</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-68><a id=__codelineno-2-68 name=__codelineno-2-68 href=#__codelineno-2-68></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>if</span><span class=nv> </span><span class=s>.Values.agent.dependencies</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-69><a id=__codelineno-2-69 name=__codelineno-2-69 href=#__codelineno-2-69></a><span class=w>        </span><span class=s>-</span><span class=nv> </span><span class=s>name:</span><span class=nv> </span><span class=s>MCP_MESH_DEPENDENCIES</span>
</span><span id=__span-2-70><a id=__codelineno-2-70 name=__codelineno-2-70 href=#__codelineno-2-70></a><span class=w>          </span><span class=s>value:</span><span class=nv> </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.agent.dependencies</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>join</span><span class=nv> </span><span class=s>&quot;</span><span class="p p-Indicator">,</span><span class=s>&quot;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>quote</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-71><a id=__codelineno-2-71 name=__codelineno-2-71 href=#__codelineno-2-71></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>end</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-72><a id=__codelineno-2-72 name=__codelineno-2-72 href=#__codelineno-2-72></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>range</span><span class=nv> </span><span class=s>$key,</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>:=</span><span class=nv> </span><span class=s>.Values.agent.env</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-73><a id=__codelineno-2-73 name=__codelineno-2-73 href=#__codelineno-2-73></a><span class=w>        </span><span class=s>-</span><span class=nv> </span><span class=s>name:</span><span class=nv> </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>$key</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-74><a id=__codelineno-2-74 name=__codelineno-2-74 href=#__codelineno-2-74></a><span class=w>          </span><span class=s>value:</span><span class=nv> </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>$value</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>quote</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-75><a id=__codelineno-2-75 name=__codelineno-2-75 href=#__codelineno-2-75></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>end</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-76><a id=__codelineno-2-76 name=__codelineno-2-76 href=#__codelineno-2-76></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>if</span><span class=nv> </span><span class=s>or</span><span class=nv> </span><span class=s>.Values.agent.configMap</span><span class=nv> </span><span class=s>.Values.agent.secret</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-77><a id=__codelineno-2-77 name=__codelineno-2-77 href=#__codelineno-2-77></a><span class=w>        </span><span class=s>envFrom:</span>
</span><span id=__span-2-78><a id=__codelineno-2-78 name=__codelineno-2-78 href=#__codelineno-2-78></a><span class=w>        </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{-</span><span class=nv> </span><span class=s>if</span><span class=nv> </span><span class=s>.Values.agent.configMap</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}</span>
</span><span id=__span-2-79><a id=__codelineno-2-79 name=__codelineno-2-79 href=#__codelineno-2-79></a><span class=w>        </span><span class=s>-</span><span class=nv> </span><span class=s>configMapRef:</span>
</span><span id=__span-2-80><a id=__codelineno-2-80 name=__codelineno-2-80 href=#__codelineno-2-80></a><span class=w>            </span><span class=s>name:</span><span class=nv> </span><span class=s>{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>include</span><span class=nv> </span><span class=s>&quot;</span><span class=nv>mcp-mesh-agent.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-81><a id=__codelineno-2-81 name=__codelineno-2-81 href=#__codelineno-2-81></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-82><a id=__codelineno-2-82 name=__codelineno-2-82 href=#__codelineno-2-82></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.secret</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-83><a id=__codelineno-2-83 name=__codelineno-2-83 href=#__codelineno-2-83></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>secretRef</span><span class=p>:</span>
</span><span id=__span-2-84><a id=__codelineno-2-84 name=__codelineno-2-84 href=#__codelineno-2-84></a><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-85><a id=__codelineno-2-85 name=__codelineno-2-85 href=#__codelineno-2-85></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-86><a id=__codelineno-2-86 name=__codelineno-2-86 href=#__codelineno-2-86></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-87><a id=__codelineno-2-87 name=__codelineno-2-87 href=#__codelineno-2-87></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.livenessProbe</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-88><a id=__codelineno-2-88 name=__codelineno-2-88 href=#__codelineno-2-88></a><span class=w>        </span><span class=nt>livenessProbe</span><span class=p>:</span>
</span><span id=__span-2-89><a id=__codelineno-2-89 name=__codelineno-2-89 href=#__codelineno-2-89></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.agent.livenessProbe | nindent 10</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-90><a id=__codelineno-2-90 name=__codelineno-2-90 href=#__codelineno-2-90></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-91><a id=__codelineno-2-91 name=__codelineno-2-91 href=#__codelineno-2-91></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.readinessProbe</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-92><a id=__codelineno-2-92 name=__codelineno-2-92 href=#__codelineno-2-92></a><span class=w>        </span><span class=nt>readinessProbe</span><span class=p>:</span>
</span><span id=__span-2-93><a id=__codelineno-2-93 name=__codelineno-2-93 href=#__codelineno-2-93></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.agent.readinessProbe | nindent 10</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-94><a id=__codelineno-2-94 name=__codelineno-2-94 href=#__codelineno-2-94></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-95><a id=__codelineno-2-95 name=__codelineno-2-95 href=#__codelineno-2-95></a><span class=w>        </span><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-2-96><a id=__codelineno-2-96 name=__codelineno-2-96 href=#__codelineno-2-96></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.resources | nindent 12</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-97><a id=__codelineno-2-97 name=__codelineno-2-97 href=#__codelineno-2-97></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.volumeMounts</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-98><a id=__codelineno-2-98 name=__codelineno-2-98 href=#__codelineno-2-98></a><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span>
</span><span id=__span-2-99><a id=__codelineno-2-99 name=__codelineno-2-99 href=#__codelineno-2-99></a><span class=w>          </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.agent.volumeMounts | nindent 10</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-100><a id=__codelineno-2-100 name=__codelineno-2-100 href=#__codelineno-2-100></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-101><a id=__codelineno-2-101 name=__codelineno-2-101 href=#__codelineno-2-101></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.volumes</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-102><a id=__codelineno-2-102 name=__codelineno-2-102 href=#__codelineno-2-102></a><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span>
</span><span id=__span-2-103><a id=__codelineno-2-103 name=__codelineno-2-103 href=#__codelineno-2-103></a><span class=w>        </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- toYaml .Values.agent.volumes | nindent 8</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-2-104><a id=__codelineno-2-104 name=__codelineno-2-104 href=#__codelineno-2-104></a><span class=w>      </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h3 id=step-4-understanding-template-helpers>Step 4: Understanding Template Helpers<a class=headerlink href=#step-4-understanding-template-helpers title="Permanent link">&para;</a></h3> <p>Helper functions provide consistency across templates:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># templates/_helpers.tpl</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class="p p-Indicator">{{</span><span class=nv>/*</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=nv>Expand the name of the chart.</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=nv>*/</span><span class="p p-Indicator">}}</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- define &quot;mcp-mesh-registry.name&quot; -</span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- default .Chart.Name .Values.nameOverride | trunc 63 | trimSuffix &quot;-&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class="p p-Indicator">{{</span><span class=nv>/*</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=nv>Create a default fully qualified app name.</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=nv>*/</span><span class="p p-Indicator">}}</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- define &quot;mcp-mesh-registry.fullname&quot; -</span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.fullnameOverride</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- .Values.fullnameOverride | trunc 63 | trimSuffix &quot;-&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- else</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- $name</span><span class=w> </span><span class="p p-Indicator">:</span><span class=nv>= default .Chart.Name .Values.nameOverride</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if contains $name .Release.Name</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- .Release.Name | trunc 63 | trimSuffix &quot;-&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- else</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- printf &quot;%s-%s&quot; .Release.Name $name | trunc 63 | trimSuffix &quot;-&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class="p p-Indicator">{{</span><span class=nv>/*</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=nv>Common labels</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=nv>*/</span><span class="p p-Indicator">}}</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- define &quot;mcp-mesh-registry.labels&quot; -</span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=nt>helm.sh/chart</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.chart&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.selectorLabels&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Chart.AppVersion</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=nt>app.kubernetes.io/version</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Chart.AppVersion | quote</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=nt>app.kubernetes.io/managed-by</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Release.Service</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class="p p-Indicator">{{</span><span class=nv>/*</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a><span class=nv>Selector labels</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a><span class=nv>*/</span><span class="p p-Indicator">}}</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- define &quot;mcp-mesh-registry.selectorLabels&quot; -</span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-registry.name&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=nt>app.kubernetes.io/instance</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Release.Name</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h3 id=step-5-values-file-structure>Step 5: Values File Structure<a class=headerlink href=#step-5-values-file-structure title="Permanent link">&para;</a></h3> <p>Understanding the values structure helps with customization:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># values.yaml structure</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=c1># Global settings</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nt>global</span><span class=p>:</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>  </span><span class=nt>imageRegistry</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>  </span><span class=nt>imagePullSecrets</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[]</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Image configuration (updated to match working examples)</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=nt>image</span><span class=p>:</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>  </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mcp-mesh-base</span><span class=w>  </span><span class=c1># 🎯 Updated from mcp-mesh/registry</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>  </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0.5.6&quot;</span><span class=w>  </span><span class=c1># 🎯 Updated for local development</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>  </span><span class=nt>pullPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Never</span><span class=w>  </span><span class=c1># 🎯 For local development</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=c1># Deployment settings</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=nt>replicaCount</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=nt>updateStrategy</span><span class=p>:</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">RollingUpdate</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=c1># Pod configuration</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=nt>podAnnotations</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=nt>podSecurityContext</span><span class=p>:</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=w>  </span><span class=nt>runAsNonRoot</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=w>  </span><span class=nt>runAsUser</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">65534</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=c1># Container configuration</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=nt>securityContext</span><span class=p>:</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=w>  </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=w>    </span><span class=nt>drop</span><span class=p>:</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=w>  </span><span class=nt>readOnlyRootFilesystem</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=c1># Service configuration (updated ports)</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=nt>service</span><span class=p>:</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span><span class=w>  </span><span class=c1># 🎯 Registry uses port 8000</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=w>    </span><span class=nt>prometheus.io/scrape</span><span class=p>:</span><span class=w> </span><span class=s>&quot;true&quot;</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a><span class=w>    </span><span class=nt>prometheus.io/port</span><span class=p>:</span><span class=w> </span><span class=s>&quot;9090&quot;</span>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=w>    </span><span class=nt>prometheus.io/path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/metrics&quot;</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=c1># Ingress configuration</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a><span class=nt>ingress</span><span class=p>:</span>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-4-43><a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a><span class=w>  </span><span class=nt>className</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</span><span id=__span-4-44><a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a><span class=w>  </span><span class=nt>hosts</span><span class=p>:</span>
</span><span id=__span-4-45><a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mcp-mesh.example.com</span>
</span><span id=__span-4-46><a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a><span class=w>      </span><span class=nt>paths</span><span class=p>:</span>
</span><span id=__span-4-47><a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
</span><span id=__span-4-48><a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a><span class=w>          </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
</span><span id=__span-4-49><a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a>
</span><span id=__span-4-50><a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a><span class=c1># Resource limits</span>
</span><span id=__span-4-51><a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a><span class=nt>resources</span><span class=p>:</span>
</span><span id=__span-4-52><a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a><span class=w>  </span><span class=nt>limits</span><span class=p>:</span>
</span><span id=__span-4-53><a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">500m</span>
</span><span id=__span-4-54><a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">512Mi</span>
</span><span id=__span-4-55><a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a><span class=w>  </span><span class=nt>requests</span><span class=p>:</span>
</span><span id=__span-4-56><a id=__codelineno-4-56 name=__codelineno-4-56 href=#__codelineno-4-56></a><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100m</span>
</span><span id=__span-4-57><a id=__codelineno-4-57 name=__codelineno-4-57 href=#__codelineno-4-57></a><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">128Mi</span>
</span><span id=__span-4-58><a id=__codelineno-4-58 name=__codelineno-4-58 href=#__codelineno-4-58></a>
</span><span id=__span-4-59><a id=__codelineno-4-59 name=__codelineno-4-59 href=#__codelineno-4-59></a><span class=c1># Autoscaling</span>
</span><span id=__span-4-60><a id=__codelineno-4-60 name=__codelineno-4-60 href=#__codelineno-4-60></a><span class=nt>autoscaling</span><span class=p>:</span>
</span><span id=__span-4-61><a id=__codelineno-4-61 name=__codelineno-4-61 href=#__codelineno-4-61></a><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-4-62><a id=__codelineno-4-62 name=__codelineno-4-62 href=#__codelineno-4-62></a><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id=__span-4-63><a id=__codelineno-4-63 name=__codelineno-4-63 href=#__codelineno-4-63></a><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-4-64><a id=__codelineno-4-64 name=__codelineno-4-64 href=#__codelineno-4-64></a><span class=w>  </span><span class=nt>targetCPUUtilizationPercentage</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</span><span id=__span-4-65><a id=__codelineno-4-65 name=__codelineno-4-65 href=#__codelineno-4-65></a>
</span><span id=__span-4-66><a id=__codelineno-4-66 name=__codelineno-4-66 href=#__codelineno-4-66></a><span class=c1># Registry-specific configuration (updated to match working examples)</span>
</span><span id=__span-4-67><a id=__codelineno-4-67 name=__codelineno-4-67 href=#__codelineno-4-67></a><span class=nt>registry</span><span class=p>:</span>
</span><span id=__span-4-68><a id=__codelineno-4-68 name=__codelineno-4-68 href=#__codelineno-4-68></a><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0.0.0.0&quot;</span>
</span><span id=__span-4-69><a id=__codelineno-4-69 name=__codelineno-4-69 href=#__codelineno-4-69></a><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span><span class=w>  </span><span class=c1># 🎯 Updated from 8080 to 8000</span>
</span><span id=__span-4-70><a id=__codelineno-4-70 name=__codelineno-4-70 href=#__codelineno-4-70></a><span class=w>  </span><span class=nt>database</span><span class=p>:</span>
</span><span id=__span-4-71><a id=__codelineno-4-71 name=__codelineno-4-71 href=#__codelineno-4-71></a><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span><span class=w>  </span><span class=c1># 🎯 Default to postgres like working examples</span>
</span><span id=__span-4-72><a id=__codelineno-4-72 name=__codelineno-4-72 href=#__codelineno-4-72></a><span class=w>    </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcp-mesh-postgres&quot;</span>
</span><span id=__span-4-73><a id=__codelineno-4-73 name=__codelineno-4-73 href=#__codelineno-4-73></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
</span><span id=__span-4-74><a id=__codelineno-4-74 name=__codelineno-4-74 href=#__codelineno-4-74></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcpmesh&quot;</span>
</span><span id=__span-4-75><a id=__codelineno-4-75 name=__codelineno-4-75 href=#__codelineno-4-75></a><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcpmesh&quot;</span>
</span><span id=__span-4-76><a id=__codelineno-4-76 name=__codelineno-4-76 href=#__codelineno-4-76></a><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/data/registry.db</span><span class=w>  </span><span class=c1># For SQLite fallback</span>
</span><span id=__span-4-77><a id=__codelineno-4-77 name=__codelineno-4-77 href=#__codelineno-4-77></a>
</span><span id=__span-4-78><a id=__codelineno-4-78 name=__codelineno-4-78 href=#__codelineno-4-78></a><span class=c1># Agent-specific configuration (updated to match working examples)</span>
</span><span id=__span-4-79><a id=__codelineno-4-79 name=__codelineno-4-79 href=#__codelineno-4-79></a><span class=nt>agent</span><span class=p>:</span>
</span><span id=__span-4-80><a id=__codelineno-4-80 name=__codelineno-4-80 href=#__codelineno-4-80></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;hello-world&quot;</span><span class=w>  </span><span class=c1># 🎯 Default agent name</span>
</span><span id=__span-4-81><a id=__codelineno-4-81 name=__codelineno-4-81 href=#__codelineno-4-81></a><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/app/agent.py&quot;</span><span class=w>  </span><span class=c1># 🎯 Updated path</span>
</span><span id=__span-4-82><a id=__codelineno-4-82 name=__codelineno-4-82 href=#__codelineno-4-82></a><span class=w>  </span><span class=nt>http</span><span class=p>:</span>
</span><span id=__span-4-83><a id=__codelineno-4-83 name=__codelineno-4-83 href=#__codelineno-4-83></a><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-4-84><a id=__codelineno-4-84 name=__codelineno-4-84 href=#__codelineno-4-84></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class=w>  </span><span class=c1># 🎯 Standard agent port</span>
</span><span id=__span-4-85><a id=__codelineno-4-85 name=__codelineno-4-85 href=#__codelineno-4-85></a><span class=w>    </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0.0.0.0&quot;</span>
</span><span id=__span-4-86><a id=__codelineno-4-86 name=__codelineno-4-86 href=#__codelineno-4-86></a><span class=w>  </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-4-87><a id=__codelineno-4-87 name=__codelineno-4-87 href=#__codelineno-4-87></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeting</span>
</span><span id=__span-4-88><a id=__codelineno-4-88 name=__codelineno-4-88 href=#__codelineno-4-88></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">translation</span>
</span><span id=__span-4-89><a id=__codelineno-4-89 name=__codelineno-4-89 href=#__codelineno-4-89></a><span class=w>  </span><span class=nt>dependencies</span><span class=p>:</span>
</span><span id=__span-4-90><a id=__codelineno-4-90 name=__codelineno-4-90 href=#__codelineno-4-90></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dictionary-service</span>
</span><span id=__span-4-91><a id=__codelineno-4-91 name=__codelineno-4-91 href=#__codelineno-4-91></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cache-service</span>
</span><span id=__span-4-92><a id=__codelineno-4-92 name=__codelineno-4-92 href=#__codelineno-4-92></a>
</span><span id=__span-4-93><a id=__codelineno-4-93 name=__codelineno-4-93 href=#__codelineno-4-93></a><span class=c1># Registry configuration for agents</span>
</span><span id=__span-4-94><a id=__codelineno-4-94 name=__codelineno-4-94 href=#__codelineno-4-94></a><span class=nt>registry</span><span class=p>:</span>
</span><span id=__span-4-95><a id=__codelineno-4-95 name=__codelineno-4-95 href=#__codelineno-4-95></a><span class=w>  </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcp-mesh-registry&quot;</span>
</span><span id=__span-4-96><a id=__codelineno-4-96 name=__codelineno-4-96 href=#__codelineno-4-96></a><span class=w>  </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=s>&quot;8000&quot;</span>
</span><span id=__span-4-97><a id=__codelineno-4-97 name=__codelineno-4-97 href=#__codelineno-4-97></a><span class=w>  </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://mcp-mesh-registry:8000&quot;</span>
</span><span id=__span-4-98><a id=__codelineno-4-98 name=__codelineno-4-98 href=#__codelineno-4-98></a>
</span><span id=__span-4-99><a id=__codelineno-4-99 name=__codelineno-4-99 href=#__codelineno-4-99></a><span class=c1># Mesh configuration</span>
</span><span id=__span-4-100><a id=__codelineno-4-100 name=__codelineno-4-100 href=#__codelineno-4-100></a><span class=nt>mesh</span><span class=p>:</span>
</span><span id=__span-4-101><a id=__codelineno-4-101 name=__codelineno-4-101 href=#__codelineno-4-101></a><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-4-102><a id=__codelineno-4-102 name=__codelineno-4-102 href=#__codelineno-4-102></a><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-4-103><a id=__codelineno-4-103 name=__codelineno-4-103 href=#__codelineno-4-103></a><span class=w>  </span><span class=nt>logLevel</span><span class=p>:</span><span class=w> </span><span class=s>&quot;INFO&quot;</span>
</span></code></pre></div> <h2 id=configuration-options>Configuration Options<a class=headerlink href=#configuration-options title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Section</th> <th>Key</th> <th>Description</th> <th>Default (Updated)</th> </tr> </thead> <tbody> <tr> <td><code>image</code></td> <td><code>repository</code></td> <td>Container image</td> <td>mcp-mesh-base</td> </tr> <tr> <td><code>image</code></td> <td><code>tag</code></td> <td>Image version</td> <td>0.5</td> </tr> <tr> <td><code>image</code></td> <td><code>pullPolicy</code></td> <td>Pull policy</td> <td>Never</td> </tr> <tr> <td><code>replicaCount</code></td> <td>-</td> <td>Number of replicas</td> <td>1</td> </tr> <tr> <td><code>service</code></td> <td><code>type</code></td> <td>Service type</td> <td>ClusterIP</td> </tr> <tr> <td><code>service</code></td> <td><code>port</code></td> <td>Service port</td> <td>8000 (registry)</td> </tr> <tr> <td><code>agent.http</code></td> <td><code>port</code></td> <td>Agent HTTP port</td> <td>8080 (agents)</td> </tr> <tr> <td><code>persistence</code></td> <td><code>enabled</code></td> <td>Enable PVC</td> <td>true</td> </tr> <tr> <td><code>persistence</code></td> <td><code>size</code></td> <td>Volume size</td> <td>5Gi</td> </tr> </tbody> </table> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <h3 id=example-1-custom-agent-chart>Example 1: Custom Agent Chart<a class=headerlink href=#example-1-custom-agent-chart title="Permanent link">&para;</a></h3> <p>Create your own agent chart based on mcp-mesh-agent:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># my-weather-agent/Chart.yaml</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">weather-agent</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Weather service agent for MCP Mesh</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">application</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=nt>appVersion</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1.0.0&quot;</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=nt>dependencies</span><span class=p>:</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mcp-mesh-agent</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0.5.6&quot;</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>    </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class=s>&quot;https://charts.mcp-mesh.io&quot;</span>
</span></code></pre></div> <p>Override values:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># my-weather-agent/values.yaml (updated to match new chart structure)</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=nt>mcp-mesh-agent</span><span class=p>:</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>  </span><span class=nt>agent</span><span class=p>:</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">weather-service</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class=nt>http</span><span class=p>:</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">weather_forecast</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">weather_history</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>    </span><span class=nt>dependencies</span><span class=p>:</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">location_service</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span><span class=nt>registry</span><span class=p>:</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>    </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcp-mesh-registry&quot;</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=s>&quot;8000&quot;</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>  </span><span class=nt>mesh</span><span class=p>:</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>    </span><span class=nt>logLevel</span><span class=p>:</span><span class=w> </span><span class=s>&quot;INFO&quot;</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>  </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>    </span><span class=nt>API_KEY</span><span class=p>:</span><span class=w> </span><span class=s>&quot;your-weather-api-key&quot;</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>    </span><span class=nt>CACHE_TTL</span><span class=p>:</span><span class=w> </span><span class=s>&quot;3600&quot;</span>
</span></code></pre></div> <h3 id=example-2-template-customization>Example 2: Template Customization<a class=headerlink href=#example-2-template-customization title="Permanent link">&para;</a></h3> <p>Add custom templates to extend functionality:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># templates/custom-job.yaml</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- if .Values.agent.migrations.enabled</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">batch/v1</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Job</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span><span class="l l-Scalar l-Scalar-Plain">-migrate</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=s>&quot;helm.sh/hook&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pre-upgrade</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>    </span><span class=s>&quot;helm.sh/hook-weight&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;-1&quot;</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>  </span><span class=nt>template</span><span class=p>:</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>      </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">migrate</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.repository</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}:{%</span><span class=nv> </span><span class=s>raw</span><span class=nv> </span><span class=s>%}{{</span><span class=nv> </span><span class=s>.Values.image.tag</span><span class=nv> </span><span class=s>}}{%</span><span class=nv> </span><span class=s>endraw</span><span class=nv> </span><span class=s>%}&quot;</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;python&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;-m&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;migrations.run&quot;</span><span class="p p-Indicator">]</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>        </span><span class=nt>env</span><span class=p>:</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=w>            </span><span class=nt>secretKeyRef</span><span class=p>:</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>              </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.fullname&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>              </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">database-url</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <ol> <li><strong>Use Subchart Pattern</strong>: Create specific charts that depend on base charts</li> <li><strong>Template Everything</strong>: Avoid hardcoded values in templates</li> <li><strong>Validate Values</strong>: Use JSON schema for values validation</li> <li><strong>Document Options</strong>: Include comprehensive values documentation</li> <li><strong>Test Templates</strong>: Use <code>helm template</code> to verify output</li> </ol> <h2 id=common-pitfalls>Common Pitfalls<a class=headerlink href=#common-pitfalls title="Permanent link">&para;</a></h2> <h3 id=pitfall-1-incorrect-indentation>Pitfall 1: Incorrect Indentation<a class=headerlink href=#pitfall-1-incorrect-indentation title="Permanent link">&para;</a></h3> <p><strong>Problem</strong>: YAML indentation errors in templates</p> <p><strong>Solution</strong>: Use nindent for consistent indentation:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nt>labels</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=w> </span><span class="p p-Indicator">{</span><span class=w> </span><span class=nv>- include &quot;mcp-mesh-agent.labels&quot; . | nindent 4</span><span class=w> </span><span class="p p-Indicator">}</span><span class=w> </span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h3 id=pitfall-2-missing-quotes>Pitfall 2: Missing Quotes<a class=headerlink href=#pitfall-2-missing-quotes title="Permanent link">&para;</a></h3> <p><strong>Problem</strong>: Special characters breaking YAML</p> <p><strong>Solution</strong>: Always quote string values:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=w> </span><span class="p p-Indicator">{</span><span class=w> </span><span class=nv>.Values.name | quote</span><span class=w> </span><span class="p p-Indicator">}</span><span class=w> </span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h2 id=testing>Testing<a class=headerlink href=#testing title="Permanent link">&para;</a></h2> <h3 id=template-testing>Template Testing<a class=headerlink href=#template-testing title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Test template rendering</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>helm<span class=w> </span>template<span class=w> </span>my-release<span class=w> </span>./mcp-mesh-registry<span class=w> </span><span class=se>\</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span>--values<span class=w> </span>values-test.yaml<span class=w> </span><span class=se>\</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span>--debug
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=c1># Validate against Kubernetes</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>helm<span class=w> </span>template<span class=w> </span>my-release<span class=w> </span>./mcp-mesh-registry<span class=w> </span><span class=p>|</span><span class=w> </span>kubectl<span class=w> </span>apply<span class=w> </span>--dry-run<span class=o>=</span>client<span class=w> </span>-f<span class=w> </span>-
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=c1># Use kubeval for validation</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>helm<span class=w> </span>template<span class=w> </span>my-release<span class=w> </span>./mcp-mesh-registry<span class=w> </span><span class=p>|</span><span class=w> </span>kubeval
</span></code></pre></div> <h3 id=unit-testing-with-helm>Unit Testing with Helm<a class=headerlink href=#unit-testing-with-helm title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># tests/deployment_test.yaml</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=nt>suite</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">test deployment</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nt>templates</span><span class=p>:</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">deployment.yaml</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=nt>tests</span><span class=p>:</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>it</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">should create deployment with correct replicas</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span><span class=nt>set</span><span class=p>:</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>      </span><span class=nt>replicaCount</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>    </span><span class=nt>asserts</span><span class=p>:</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>equal</span><span class=p>:</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">spec.replicas</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>it</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">should have correct image</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>    </span><span class=nt>set</span><span class=p>:</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>      </span><span class=nt>image.repository</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">custom/image</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>      </span><span class=nt>image.tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v2.0.0</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=w>    </span><span class=nt>asserts</span><span class=p>:</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>equal</span><span class=p>:</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">spec.template.spec.containers[0].image</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">custom/image:v2.0.0</span>
</span></code></pre></div> <h2 id=monitoring-and-debugging>Monitoring and Debugging<a class=headerlink href=#monitoring-and-debugging title="Permanent link">&para;</a></h2> <h3 id=debug-helm-installations>Debug Helm Installations<a class=headerlink href=#debug-helm-installations title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Get release values</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>helm<span class=w> </span>get<span class=w> </span>values<span class=w> </span>my-release<span class=w> </span>-n<span class=w> </span>mcp-mesh
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=c1># Get generated manifests</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>helm<span class=w> </span>get<span class=w> </span>manifest<span class=w> </span>my-release<span class=w> </span>-n<span class=w> </span>mcp-mesh
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=c1># Debug installation issues</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>helm<span class=w> </span>install<span class=w> </span>my-release<span class=w> </span>./mcp-mesh-registry<span class=w> </span><span class=se>\</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>  </span>--debug<span class=w> </span><span class=se>\</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>  </span>--dry-run
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=c1># Check hooks</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>helm<span class=w> </span>get<span class=w> </span>hooks<span class=w> </span>my-release<span class=w> </span>-n<span class=w> </span>mcp-mesh
</span></code></pre></div> <h3 id=monitor-chart-usage>Monitor Chart Usage<a class=headerlink href=#monitor-chart-usage title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># List all releases</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>helm<span class=w> </span>list<span class=w> </span>-A
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># Get release history</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>helm<span class=w> </span><span class=nb>history</span><span class=w> </span>my-release<span class=w> </span>-n<span class=w> </span>mcp-mesh
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=c1># Check release status</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>helm<span class=w> </span>status<span class=w> </span>my-release<span class=w> </span>-n<span class=w> </span>mcp-mesh
</span></code></pre></div> <h2 id=troubleshooting>🔧 Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <h3 id=issue-1-template-function-not-found>Issue 1: Template Function Not Found<a class=headerlink href=#issue-1-template-function-not-found title="Permanent link">&para;</a></h3> <p><strong>Symptoms</strong>: <code>function "x" not defined</code></p> <p><strong>Cause</strong>: Missing or incorrectly named helper</p> <p><strong>Solution</strong>:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Ensure helper is defined in _helpers.tpl</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- define &quot;mcp-mesh-agent.name&quot; -</span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- default .Chart.Name .Values.nameOverride | trunc 63 | trimSuffix &quot;-&quot;</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=nv>- end</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=c1># Use correct name in template</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>include &quot;mcp-mesh-agent.name&quot; .</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span></code></pre></div> <h3 id=issue-2-values-not-propagating>Issue 2: Values Not Propagating<a class=headerlink href=#issue-2-values-not-propagating title="Permanent link">&para;</a></h3> <p><strong>Symptoms</strong>: Default values used instead of custom values</p> <p><strong>Cause</strong>: Incorrect values path or missing defaults</p> <p><strong>Solution</strong>:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># Use default function</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=err>%</span><span class=w> </span><span class=nv>raw %</span><span class="p p-Indicator">}{{</span><span class=w> </span><span class=nv>.Values.agent.port | default 8080</span><span class=w> </span><span class="p p-Indicator">}}{</span><span class=err>%</span><span class=w> </span><span class=nv>endraw %</span><span class="p p-Indicator">}</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=c1># Check values path</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class="l l-Scalar l-Scalar-Plain">helm get values my-release -n mcp-mesh</span>
</span></code></pre></div> <p>For more issues, see the <a href=../troubleshooting/ >section troubleshooting guide</a>.</p> <h2 id=known-limitations>⚠️ Known Limitations<a class=headerlink href=#known-limitations title="Permanent link">&para;</a></h2> <ul> <li><strong>ConfigMap Size</strong>: Limited to 1MB for values</li> <li><strong>Template Complexity</strong>: Go templates can be hard to debug</li> <li><strong>CRD Handling</strong>: CRDs need special treatment in Helm 3</li> <li><strong>Nested Dependencies</strong>: Limited to one level of dependencies</li> </ul> <h2 id=todo>📝 TODO<a class=headerlink href=#todo title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Add JSON schema for values validation</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Create chart testing CI pipeline</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Add more helper functions</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Document advanced templating patterns</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Create chart development guide</li> </ul> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">&para;</a></h2> <p>You now understand the updated structure and components of MCP Mesh Helm charts:</p> <p>Key takeaways:</p> <ul> <li>🔑 <strong>Registry chart</strong>: Uses StatefulSet with port 8000, matches working K8s examples</li> <li>🔑 <strong>Agent chart</strong>: Includes automatic service discovery from <code>app.kubernetes.io/name</code> labels</li> <li>🔑 <strong>Service discovery</strong>: Auto-detects SERVICE_NAME and NAMESPACE from Kubernetes metadata</li> <li>🔑 <strong>Image consistency</strong>: Both charts use <code>mcp-mesh-base:0.2</code> with <code>Never</code> pull policy</li> <li>🔑 <strong>Port standardization</strong>: Registry=8000, Agents=8080</li> <li>🔑 <strong>Health endpoints</strong>: All use <code>/health</code> for startup, liveness, and readiness probes</li> </ul> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <p>Let's create a platform umbrella chart to deploy everything together.</p> <p>Continue to <a href=../02-umbrella-chart/ >Platform Umbrella Chart</a> →</p> <hr> <p>💡 <strong>Tip</strong>: Use <code>helm lint</code> to check your charts for common issues before deployment</p> <p>📚 <strong>Reference</strong>: <a href=https://helm.sh/docs/chart_best_practices/ >Helm Chart Best Practices</a></p> <p>🧪 <strong>Try It</strong>: Create a custom chart for your agent that extends the base mcp-mesh-agent chart</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 1, 2025 01:34:08 UTC"><span class=timeago datetime=2025-10-01T01:34:08+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 1, 2025 01:34:08 UTC">2025-10-01</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="June 12, 2025 18:17:58 UTC"><span class=timeago datetime=2025-06-12T18:17:58+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="June 12, 2025 18:17:58 UTC">2025-06-12</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Overview </div> </div> </a> <a href=../02-umbrella-chart/ class="md-footer__link md-footer__link--next" aria-label="Next: Multi-Agent Deployment"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Multi-Agent Deployment </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2025 MCP Mesh Contributors </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/dhyansraj/mcp-mesh target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/KDFDREphWn target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=https://pypi.org/project/mcp-mesh/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../assets/javascripts/extra.js></script> </body> </html>