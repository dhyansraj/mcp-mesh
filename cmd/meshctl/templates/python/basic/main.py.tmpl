#!/usr/bin/env python3
"""
{{ .Name }} - MCP Mesh Agent

{{ if .Description }}{{ .Description }}{{ else }}A MCP Mesh agent generated using meshctl scaffold.{{ end }}
"""

from typing import Any

import mesh
from fastmcp import FastMCP

# FastMCP server instance
app = FastMCP("{{ toPascalCase .Name }} Service")


# ===== TOOLS =====

@app.tool()
@mesh.tool(
    capability="{{ .ToolName | default "hello" }}",
    description="{{ .ToolDescription | default "A tool" }}",
    tags={{ if .Tags }}{{ toJSON .Tags }}{{ else }}["tools"]{{ end }},
)
async def {{ .ToolName | default "hello" }}() -> str:
    """
    {{ .ToolDescription | default "A tool" }}.

    Returns:
        Result string.
    """
    # TODO: Implement tool logic
    return "Not implemented"


# ===== AGENT CONFIGURATION =====

@mesh.agent(
    name="{{ .Name }}",
    version="1.0.0",
    description="{{ if .Description }}{{ .Description }}{{ else }}MCP Mesh agent for {{ .Name }}{{ end }}",
    http_port={{ .Port }},
    enable_http=True,
    auto_run=True,
)
class {{ toPascalCase .Name }}Agent:
    """
    Agent class that configures how mesh should run the FastMCP server.

    The mesh processor will:
    1. Discover the 'app' FastMCP instance
    2. Apply dependency injection to decorated functions
    3. Start the FastMCP HTTP server on the configured port
    4. Register all capabilities with the mesh registry
    """

    pass


# No main method needed!
# Mesh processor automatically handles:
# - FastMCP server discovery and startup
# - Dependency injection between functions
# - HTTP server configuration
# - Service registration with mesh registry
