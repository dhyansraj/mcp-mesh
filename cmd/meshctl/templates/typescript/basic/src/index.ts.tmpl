#!/usr/bin/env npx tsx
/**
 * {{ .Name }} - MCP Mesh Agent
 *
 * {{ if .Description }}{{ .Description }}{{ else }}A MCP Mesh agent generated using meshctl scaffold.{{ end }}
 */

import { FastMCP } from "fastmcp";
import { mesh } from "@mcpmesh/sdk";
import { z } from "zod";

// FastMCP server instance
const server = new FastMCP({
  name: "{{ toPascalCase .Name }} Service",
  version: "1.0.0",
});

// ===== TOOLS =====

server.addTool(
  mesh.tool({
    name: "{{ .ToolName | default "hello" }}",
    capability: "{{ .ToolName | default "hello" }}",
    description: "{{ .ToolDescription | default "A tool" }}",
    tags: {{ if .Tags }}{{ toJSON .Tags }}{{ else }}["tools"]{{ end }},
    parameters: z.object({
      // TODO: Define your input parameters
    }),
    execute: async (args) => {
      // TODO: Implement tool logic
      return "Not implemented";
    },
  })
);

// ===== AGENT CONFIGURATION =====

const agent = mesh(server, {
  name: "{{ .Name }}",
  port: {{ .Port }},
});

// No server.start() needed!
// Mesh SDK automatically handles:
// - FastMCP server startup
// - HTTP server configuration
// - Service registration with mesh registry
