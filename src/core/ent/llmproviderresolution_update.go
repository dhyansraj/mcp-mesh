// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"mcp-mesh/src/core/ent/agent"
	"mcp-mesh/src/core/ent/llmproviderresolution"
	"mcp-mesh/src/core/ent/predicate"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/dialect/sql/sqljson"
	"entgo.io/ent/schema/field"
)

// LLMProviderResolutionUpdate is the builder for updating LLMProviderResolution entities.
type LLMProviderResolutionUpdate struct {
	config
	hooks    []Hook
	mutation *LLMProviderResolutionMutation
}

// Where appends a list predicates to the LLMProviderResolutionUpdate builder.
func (lpru *LLMProviderResolutionUpdate) Where(ps ...predicate.LLMProviderResolution) *LLMProviderResolutionUpdate {
	lpru.mutation.Where(ps...)
	return lpru
}

// SetConsumerAgentID sets the "consumer_agent_id" field.
func (lpru *LLMProviderResolutionUpdate) SetConsumerAgentID(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetConsumerAgentID(s)
	return lpru
}

// SetNillableConsumerAgentID sets the "consumer_agent_id" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableConsumerAgentID(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetConsumerAgentID(*s)
	}
	return lpru
}

// SetConsumerFunctionName sets the "consumer_function_name" field.
func (lpru *LLMProviderResolutionUpdate) SetConsumerFunctionName(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetConsumerFunctionName(s)
	return lpru
}

// SetNillableConsumerFunctionName sets the "consumer_function_name" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableConsumerFunctionName(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetConsumerFunctionName(*s)
	}
	return lpru
}

// SetRequiredCapability sets the "required_capability" field.
func (lpru *LLMProviderResolutionUpdate) SetRequiredCapability(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetRequiredCapability(s)
	return lpru
}

// SetNillableRequiredCapability sets the "required_capability" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableRequiredCapability(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetRequiredCapability(*s)
	}
	return lpru
}

// SetRequiredTags sets the "required_tags" field.
func (lpru *LLMProviderResolutionUpdate) SetRequiredTags(s []string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetRequiredTags(s)
	return lpru
}

// AppendRequiredTags appends s to the "required_tags" field.
func (lpru *LLMProviderResolutionUpdate) AppendRequiredTags(s []string) *LLMProviderResolutionUpdate {
	lpru.mutation.AppendRequiredTags(s)
	return lpru
}

// ClearRequiredTags clears the value of the "required_tags" field.
func (lpru *LLMProviderResolutionUpdate) ClearRequiredTags() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearRequiredTags()
	return lpru
}

// SetRequiredVersion sets the "required_version" field.
func (lpru *LLMProviderResolutionUpdate) SetRequiredVersion(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetRequiredVersion(s)
	return lpru
}

// SetNillableRequiredVersion sets the "required_version" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableRequiredVersion(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetRequiredVersion(*s)
	}
	return lpru
}

// ClearRequiredVersion clears the value of the "required_version" field.
func (lpru *LLMProviderResolutionUpdate) ClearRequiredVersion() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearRequiredVersion()
	return lpru
}

// SetRequiredNamespace sets the "required_namespace" field.
func (lpru *LLMProviderResolutionUpdate) SetRequiredNamespace(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetRequiredNamespace(s)
	return lpru
}

// SetNillableRequiredNamespace sets the "required_namespace" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableRequiredNamespace(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetRequiredNamespace(*s)
	}
	return lpru
}

// SetProviderAgentID sets the "provider_agent_id" field.
func (lpru *LLMProviderResolutionUpdate) SetProviderAgentID(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetProviderAgentID(s)
	return lpru
}

// SetNillableProviderAgentID sets the "provider_agent_id" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableProviderAgentID(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetProviderAgentID(*s)
	}
	return lpru
}

// ClearProviderAgentID clears the value of the "provider_agent_id" field.
func (lpru *LLMProviderResolutionUpdate) ClearProviderAgentID() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearProviderAgentID()
	return lpru
}

// SetProviderFunctionName sets the "provider_function_name" field.
func (lpru *LLMProviderResolutionUpdate) SetProviderFunctionName(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetProviderFunctionName(s)
	return lpru
}

// SetNillableProviderFunctionName sets the "provider_function_name" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableProviderFunctionName(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetProviderFunctionName(*s)
	}
	return lpru
}

// ClearProviderFunctionName clears the value of the "provider_function_name" field.
func (lpru *LLMProviderResolutionUpdate) ClearProviderFunctionName() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearProviderFunctionName()
	return lpru
}

// SetEndpoint sets the "endpoint" field.
func (lpru *LLMProviderResolutionUpdate) SetEndpoint(s string) *LLMProviderResolutionUpdate {
	lpru.mutation.SetEndpoint(s)
	return lpru
}

// SetNillableEndpoint sets the "endpoint" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableEndpoint(s *string) *LLMProviderResolutionUpdate {
	if s != nil {
		lpru.SetEndpoint(*s)
	}
	return lpru
}

// ClearEndpoint clears the value of the "endpoint" field.
func (lpru *LLMProviderResolutionUpdate) ClearEndpoint() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearEndpoint()
	return lpru
}

// SetStatus sets the "status" field.
func (lpru *LLMProviderResolutionUpdate) SetStatus(l llmproviderresolution.Status) *LLMProviderResolutionUpdate {
	lpru.mutation.SetStatus(l)
	return lpru
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableStatus(l *llmproviderresolution.Status) *LLMProviderResolutionUpdate {
	if l != nil {
		lpru.SetStatus(*l)
	}
	return lpru
}

// SetResolvedAt sets the "resolved_at" field.
func (lpru *LLMProviderResolutionUpdate) SetResolvedAt(t time.Time) *LLMProviderResolutionUpdate {
	lpru.mutation.SetResolvedAt(t)
	return lpru
}

// SetNillableResolvedAt sets the "resolved_at" field if the given value is not nil.
func (lpru *LLMProviderResolutionUpdate) SetNillableResolvedAt(t *time.Time) *LLMProviderResolutionUpdate {
	if t != nil {
		lpru.SetResolvedAt(*t)
	}
	return lpru
}

// ClearResolvedAt clears the value of the "resolved_at" field.
func (lpru *LLMProviderResolutionUpdate) ClearResolvedAt() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearResolvedAt()
	return lpru
}

// SetUpdatedAt sets the "updated_at" field.
func (lpru *LLMProviderResolutionUpdate) SetUpdatedAt(t time.Time) *LLMProviderResolutionUpdate {
	lpru.mutation.SetUpdatedAt(t)
	return lpru
}

// SetConsumerAgent sets the "consumer_agent" edge to the Agent entity.
func (lpru *LLMProviderResolutionUpdate) SetConsumerAgent(a *Agent) *LLMProviderResolutionUpdate {
	return lpru.SetConsumerAgentID(a.ID)
}

// SetProviderAgent sets the "provider_agent" edge to the Agent entity.
func (lpru *LLMProviderResolutionUpdate) SetProviderAgent(a *Agent) *LLMProviderResolutionUpdate {
	return lpru.SetProviderAgentID(a.ID)
}

// Mutation returns the LLMProviderResolutionMutation object of the builder.
func (lpru *LLMProviderResolutionUpdate) Mutation() *LLMProviderResolutionMutation {
	return lpru.mutation
}

// ClearConsumerAgent clears the "consumer_agent" edge to the Agent entity.
func (lpru *LLMProviderResolutionUpdate) ClearConsumerAgent() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearConsumerAgent()
	return lpru
}

// ClearProviderAgent clears the "provider_agent" edge to the Agent entity.
func (lpru *LLMProviderResolutionUpdate) ClearProviderAgent() *LLMProviderResolutionUpdate {
	lpru.mutation.ClearProviderAgent()
	return lpru
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (lpru *LLMProviderResolutionUpdate) Save(ctx context.Context) (int, error) {
	lpru.defaults()
	return withHooks(ctx, lpru.sqlSave, lpru.mutation, lpru.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (lpru *LLMProviderResolutionUpdate) SaveX(ctx context.Context) int {
	affected, err := lpru.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (lpru *LLMProviderResolutionUpdate) Exec(ctx context.Context) error {
	_, err := lpru.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (lpru *LLMProviderResolutionUpdate) ExecX(ctx context.Context) {
	if err := lpru.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (lpru *LLMProviderResolutionUpdate) defaults() {
	if _, ok := lpru.mutation.UpdatedAt(); !ok {
		v := llmproviderresolution.UpdateDefaultUpdatedAt()
		lpru.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (lpru *LLMProviderResolutionUpdate) check() error {
	if v, ok := lpru.mutation.Status(); ok {
		if err := llmproviderresolution.StatusValidator(v); err != nil {
			return &ValidationError{Name: "status", err: fmt.Errorf(`ent: validator failed for field "LLMProviderResolution.status": %w`, err)}
		}
	}
	if lpru.mutation.ConsumerAgentCleared() && len(lpru.mutation.ConsumerAgentIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "LLMProviderResolution.consumer_agent"`)
	}
	return nil
}

func (lpru *LLMProviderResolutionUpdate) sqlSave(ctx context.Context) (n int, err error) {
	if err := lpru.check(); err != nil {
		return n, err
	}
	_spec := sqlgraph.NewUpdateSpec(llmproviderresolution.Table, llmproviderresolution.Columns, sqlgraph.NewFieldSpec(llmproviderresolution.FieldID, field.TypeInt))
	if ps := lpru.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := lpru.mutation.ConsumerFunctionName(); ok {
		_spec.SetField(llmproviderresolution.FieldConsumerFunctionName, field.TypeString, value)
	}
	if value, ok := lpru.mutation.RequiredCapability(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredCapability, field.TypeString, value)
	}
	if value, ok := lpru.mutation.RequiredTags(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredTags, field.TypeJSON, value)
	}
	if value, ok := lpru.mutation.AppendedRequiredTags(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, llmproviderresolution.FieldRequiredTags, value)
		})
	}
	if lpru.mutation.RequiredTagsCleared() {
		_spec.ClearField(llmproviderresolution.FieldRequiredTags, field.TypeJSON)
	}
	if value, ok := lpru.mutation.RequiredVersion(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredVersion, field.TypeString, value)
	}
	if lpru.mutation.RequiredVersionCleared() {
		_spec.ClearField(llmproviderresolution.FieldRequiredVersion, field.TypeString)
	}
	if value, ok := lpru.mutation.RequiredNamespace(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredNamespace, field.TypeString, value)
	}
	if value, ok := lpru.mutation.ProviderFunctionName(); ok {
		_spec.SetField(llmproviderresolution.FieldProviderFunctionName, field.TypeString, value)
	}
	if lpru.mutation.ProviderFunctionNameCleared() {
		_spec.ClearField(llmproviderresolution.FieldProviderFunctionName, field.TypeString)
	}
	if value, ok := lpru.mutation.Endpoint(); ok {
		_spec.SetField(llmproviderresolution.FieldEndpoint, field.TypeString, value)
	}
	if lpru.mutation.EndpointCleared() {
		_spec.ClearField(llmproviderresolution.FieldEndpoint, field.TypeString)
	}
	if value, ok := lpru.mutation.Status(); ok {
		_spec.SetField(llmproviderresolution.FieldStatus, field.TypeEnum, value)
	}
	if value, ok := lpru.mutation.ResolvedAt(); ok {
		_spec.SetField(llmproviderresolution.FieldResolvedAt, field.TypeTime, value)
	}
	if lpru.mutation.ResolvedAtCleared() {
		_spec.ClearField(llmproviderresolution.FieldResolvedAt, field.TypeTime)
	}
	if value, ok := lpru.mutation.UpdatedAt(); ok {
		_spec.SetField(llmproviderresolution.FieldUpdatedAt, field.TypeTime, value)
	}
	if lpru.mutation.ConsumerAgentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   llmproviderresolution.ConsumerAgentTable,
			Columns: []string{llmproviderresolution.ConsumerAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := lpru.mutation.ConsumerAgentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   llmproviderresolution.ConsumerAgentTable,
			Columns: []string{llmproviderresolution.ConsumerAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if lpru.mutation.ProviderAgentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: false,
			Table:   llmproviderresolution.ProviderAgentTable,
			Columns: []string{llmproviderresolution.ProviderAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := lpru.mutation.ProviderAgentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: false,
			Table:   llmproviderresolution.ProviderAgentTable,
			Columns: []string{llmproviderresolution.ProviderAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if n, err = sqlgraph.UpdateNodes(ctx, lpru.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{llmproviderresolution.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	lpru.mutation.done = true
	return n, nil
}

// LLMProviderResolutionUpdateOne is the builder for updating a single LLMProviderResolution entity.
type LLMProviderResolutionUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *LLMProviderResolutionMutation
}

// SetConsumerAgentID sets the "consumer_agent_id" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetConsumerAgentID(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetConsumerAgentID(s)
	return lpruo
}

// SetNillableConsumerAgentID sets the "consumer_agent_id" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableConsumerAgentID(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetConsumerAgentID(*s)
	}
	return lpruo
}

// SetConsumerFunctionName sets the "consumer_function_name" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetConsumerFunctionName(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetConsumerFunctionName(s)
	return lpruo
}

// SetNillableConsumerFunctionName sets the "consumer_function_name" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableConsumerFunctionName(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetConsumerFunctionName(*s)
	}
	return lpruo
}

// SetRequiredCapability sets the "required_capability" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetRequiredCapability(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetRequiredCapability(s)
	return lpruo
}

// SetNillableRequiredCapability sets the "required_capability" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableRequiredCapability(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetRequiredCapability(*s)
	}
	return lpruo
}

// SetRequiredTags sets the "required_tags" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetRequiredTags(s []string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetRequiredTags(s)
	return lpruo
}

// AppendRequiredTags appends s to the "required_tags" field.
func (lpruo *LLMProviderResolutionUpdateOne) AppendRequiredTags(s []string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.AppendRequiredTags(s)
	return lpruo
}

// ClearRequiredTags clears the value of the "required_tags" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearRequiredTags() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearRequiredTags()
	return lpruo
}

// SetRequiredVersion sets the "required_version" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetRequiredVersion(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetRequiredVersion(s)
	return lpruo
}

// SetNillableRequiredVersion sets the "required_version" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableRequiredVersion(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetRequiredVersion(*s)
	}
	return lpruo
}

// ClearRequiredVersion clears the value of the "required_version" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearRequiredVersion() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearRequiredVersion()
	return lpruo
}

// SetRequiredNamespace sets the "required_namespace" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetRequiredNamespace(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetRequiredNamespace(s)
	return lpruo
}

// SetNillableRequiredNamespace sets the "required_namespace" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableRequiredNamespace(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetRequiredNamespace(*s)
	}
	return lpruo
}

// SetProviderAgentID sets the "provider_agent_id" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetProviderAgentID(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetProviderAgentID(s)
	return lpruo
}

// SetNillableProviderAgentID sets the "provider_agent_id" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableProviderAgentID(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetProviderAgentID(*s)
	}
	return lpruo
}

// ClearProviderAgentID clears the value of the "provider_agent_id" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearProviderAgentID() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearProviderAgentID()
	return lpruo
}

// SetProviderFunctionName sets the "provider_function_name" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetProviderFunctionName(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetProviderFunctionName(s)
	return lpruo
}

// SetNillableProviderFunctionName sets the "provider_function_name" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableProviderFunctionName(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetProviderFunctionName(*s)
	}
	return lpruo
}

// ClearProviderFunctionName clears the value of the "provider_function_name" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearProviderFunctionName() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearProviderFunctionName()
	return lpruo
}

// SetEndpoint sets the "endpoint" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetEndpoint(s string) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetEndpoint(s)
	return lpruo
}

// SetNillableEndpoint sets the "endpoint" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableEndpoint(s *string) *LLMProviderResolutionUpdateOne {
	if s != nil {
		lpruo.SetEndpoint(*s)
	}
	return lpruo
}

// ClearEndpoint clears the value of the "endpoint" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearEndpoint() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearEndpoint()
	return lpruo
}

// SetStatus sets the "status" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetStatus(l llmproviderresolution.Status) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetStatus(l)
	return lpruo
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableStatus(l *llmproviderresolution.Status) *LLMProviderResolutionUpdateOne {
	if l != nil {
		lpruo.SetStatus(*l)
	}
	return lpruo
}

// SetResolvedAt sets the "resolved_at" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetResolvedAt(t time.Time) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetResolvedAt(t)
	return lpruo
}

// SetNillableResolvedAt sets the "resolved_at" field if the given value is not nil.
func (lpruo *LLMProviderResolutionUpdateOne) SetNillableResolvedAt(t *time.Time) *LLMProviderResolutionUpdateOne {
	if t != nil {
		lpruo.SetResolvedAt(*t)
	}
	return lpruo
}

// ClearResolvedAt clears the value of the "resolved_at" field.
func (lpruo *LLMProviderResolutionUpdateOne) ClearResolvedAt() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearResolvedAt()
	return lpruo
}

// SetUpdatedAt sets the "updated_at" field.
func (lpruo *LLMProviderResolutionUpdateOne) SetUpdatedAt(t time.Time) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.SetUpdatedAt(t)
	return lpruo
}

// SetConsumerAgent sets the "consumer_agent" edge to the Agent entity.
func (lpruo *LLMProviderResolutionUpdateOne) SetConsumerAgent(a *Agent) *LLMProviderResolutionUpdateOne {
	return lpruo.SetConsumerAgentID(a.ID)
}

// SetProviderAgent sets the "provider_agent" edge to the Agent entity.
func (lpruo *LLMProviderResolutionUpdateOne) SetProviderAgent(a *Agent) *LLMProviderResolutionUpdateOne {
	return lpruo.SetProviderAgentID(a.ID)
}

// Mutation returns the LLMProviderResolutionMutation object of the builder.
func (lpruo *LLMProviderResolutionUpdateOne) Mutation() *LLMProviderResolutionMutation {
	return lpruo.mutation
}

// ClearConsumerAgent clears the "consumer_agent" edge to the Agent entity.
func (lpruo *LLMProviderResolutionUpdateOne) ClearConsumerAgent() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearConsumerAgent()
	return lpruo
}

// ClearProviderAgent clears the "provider_agent" edge to the Agent entity.
func (lpruo *LLMProviderResolutionUpdateOne) ClearProviderAgent() *LLMProviderResolutionUpdateOne {
	lpruo.mutation.ClearProviderAgent()
	return lpruo
}

// Where appends a list predicates to the LLMProviderResolutionUpdate builder.
func (lpruo *LLMProviderResolutionUpdateOne) Where(ps ...predicate.LLMProviderResolution) *LLMProviderResolutionUpdateOne {
	lpruo.mutation.Where(ps...)
	return lpruo
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (lpruo *LLMProviderResolutionUpdateOne) Select(field string, fields ...string) *LLMProviderResolutionUpdateOne {
	lpruo.fields = append([]string{field}, fields...)
	return lpruo
}

// Save executes the query and returns the updated LLMProviderResolution entity.
func (lpruo *LLMProviderResolutionUpdateOne) Save(ctx context.Context) (*LLMProviderResolution, error) {
	lpruo.defaults()
	return withHooks(ctx, lpruo.sqlSave, lpruo.mutation, lpruo.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (lpruo *LLMProviderResolutionUpdateOne) SaveX(ctx context.Context) *LLMProviderResolution {
	node, err := lpruo.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (lpruo *LLMProviderResolutionUpdateOne) Exec(ctx context.Context) error {
	_, err := lpruo.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (lpruo *LLMProviderResolutionUpdateOne) ExecX(ctx context.Context) {
	if err := lpruo.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (lpruo *LLMProviderResolutionUpdateOne) defaults() {
	if _, ok := lpruo.mutation.UpdatedAt(); !ok {
		v := llmproviderresolution.UpdateDefaultUpdatedAt()
		lpruo.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (lpruo *LLMProviderResolutionUpdateOne) check() error {
	if v, ok := lpruo.mutation.Status(); ok {
		if err := llmproviderresolution.StatusValidator(v); err != nil {
			return &ValidationError{Name: "status", err: fmt.Errorf(`ent: validator failed for field "LLMProviderResolution.status": %w`, err)}
		}
	}
	if lpruo.mutation.ConsumerAgentCleared() && len(lpruo.mutation.ConsumerAgentIDs()) > 0 {
		return errors.New(`ent: clearing a required unique edge "LLMProviderResolution.consumer_agent"`)
	}
	return nil
}

func (lpruo *LLMProviderResolutionUpdateOne) sqlSave(ctx context.Context) (_node *LLMProviderResolution, err error) {
	if err := lpruo.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(llmproviderresolution.Table, llmproviderresolution.Columns, sqlgraph.NewFieldSpec(llmproviderresolution.FieldID, field.TypeInt))
	id, ok := lpruo.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "LLMProviderResolution.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := lpruo.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, llmproviderresolution.FieldID)
		for _, f := range fields {
			if !llmproviderresolution.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != llmproviderresolution.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := lpruo.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := lpruo.mutation.ConsumerFunctionName(); ok {
		_spec.SetField(llmproviderresolution.FieldConsumerFunctionName, field.TypeString, value)
	}
	if value, ok := lpruo.mutation.RequiredCapability(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredCapability, field.TypeString, value)
	}
	if value, ok := lpruo.mutation.RequiredTags(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredTags, field.TypeJSON, value)
	}
	if value, ok := lpruo.mutation.AppendedRequiredTags(); ok {
		_spec.AddModifier(func(u *sql.UpdateBuilder) {
			sqljson.Append(u, llmproviderresolution.FieldRequiredTags, value)
		})
	}
	if lpruo.mutation.RequiredTagsCleared() {
		_spec.ClearField(llmproviderresolution.FieldRequiredTags, field.TypeJSON)
	}
	if value, ok := lpruo.mutation.RequiredVersion(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredVersion, field.TypeString, value)
	}
	if lpruo.mutation.RequiredVersionCleared() {
		_spec.ClearField(llmproviderresolution.FieldRequiredVersion, field.TypeString)
	}
	if value, ok := lpruo.mutation.RequiredNamespace(); ok {
		_spec.SetField(llmproviderresolution.FieldRequiredNamespace, field.TypeString, value)
	}
	if value, ok := lpruo.mutation.ProviderFunctionName(); ok {
		_spec.SetField(llmproviderresolution.FieldProviderFunctionName, field.TypeString, value)
	}
	if lpruo.mutation.ProviderFunctionNameCleared() {
		_spec.ClearField(llmproviderresolution.FieldProviderFunctionName, field.TypeString)
	}
	if value, ok := lpruo.mutation.Endpoint(); ok {
		_spec.SetField(llmproviderresolution.FieldEndpoint, field.TypeString, value)
	}
	if lpruo.mutation.EndpointCleared() {
		_spec.ClearField(llmproviderresolution.FieldEndpoint, field.TypeString)
	}
	if value, ok := lpruo.mutation.Status(); ok {
		_spec.SetField(llmproviderresolution.FieldStatus, field.TypeEnum, value)
	}
	if value, ok := lpruo.mutation.ResolvedAt(); ok {
		_spec.SetField(llmproviderresolution.FieldResolvedAt, field.TypeTime, value)
	}
	if lpruo.mutation.ResolvedAtCleared() {
		_spec.ClearField(llmproviderresolution.FieldResolvedAt, field.TypeTime)
	}
	if value, ok := lpruo.mutation.UpdatedAt(); ok {
		_spec.SetField(llmproviderresolution.FieldUpdatedAt, field.TypeTime, value)
	}
	if lpruo.mutation.ConsumerAgentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   llmproviderresolution.ConsumerAgentTable,
			Columns: []string{llmproviderresolution.ConsumerAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := lpruo.mutation.ConsumerAgentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: true,
			Table:   llmproviderresolution.ConsumerAgentTable,
			Columns: []string{llmproviderresolution.ConsumerAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	if lpruo.mutation.ProviderAgentCleared() {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: false,
			Table:   llmproviderresolution.ProviderAgentTable,
			Columns: []string{llmproviderresolution.ProviderAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		_spec.Edges.Clear = append(_spec.Edges.Clear, edge)
	}
	if nodes := lpruo.mutation.ProviderAgentIDs(); len(nodes) > 0 {
		edge := &sqlgraph.EdgeSpec{
			Rel:     sqlgraph.M2O,
			Inverse: false,
			Table:   llmproviderresolution.ProviderAgentTable,
			Columns: []string{llmproviderresolution.ProviderAgentColumn},
			Bidi:    false,
			Target: &sqlgraph.EdgeTarget{
				IDSpec: sqlgraph.NewFieldSpec(agent.FieldID, field.TypeString),
			},
		}
		for _, k := range nodes {
			edge.Target.Nodes = append(edge.Target.Nodes, k)
		}
		_spec.Edges.Add = append(_spec.Edges.Add, edge)
	}
	_node = &LLMProviderResolution{config: lpruo.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, lpruo.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{llmproviderresolution.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	lpruo.mutation.done = true
	return _node, nil
}
